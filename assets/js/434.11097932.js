(window.webpackJsonp=window.webpackJsonp||[]).push([[434],{739:function(t,a,i){"use strict";i.r(a);var s=i(4),p=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"突发-gitee-图床-废了"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#突发-gitee-图床-废了"}},[t._v("#")]),t._v(" 突发！Gitee 图床，废了！")]),t._v(" "),a("blockquote",[a("p",[t._v("本文作者："),a("a",{attrs:{href:"https://yuyuanweb.feishu.cn/wiki/Abldw5WkjidySxkKxU2cQdAtnah",target:"_blank",rel:"noopener noreferrer"}},[t._v("程序员鱼皮"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("本站地址："),a("a",{attrs:{href:"https://codefather.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://codefather.cn"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("大家好，我是鱼皮，这两天又发生了一件挺意外的事情：Gitee 的图床废了！")]),t._v(" "),a("blockquote",[a("p",[t._v("图床：指储存图片的服务器，便于在网上展示图片")])]),t._v(" "),a("p",[t._v("昨天晚上，星球里不止一位小伙伴发帖子表示自己网站、文章中的图片竟然全部变成了 Gitee 的图标？！")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233311.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("我当时还不了解真相，心想 Gitee 这么大的代码开源平台也能挂？就问小伙伴怎么回事：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233306.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("我想，如果是官方的问题，那肯定很多用 Gitee 来做图床的项目文档都会受到影响。于是我就去 GitHub 上随便搜了几个项目，果不其然，很多项目文档里的图标都变成了 Gitee。")]),t._v(" "),a("p",[t._v("千万别小看这个事情的影响！一方面是闹了不少笑话，比如下图这个项目的赞助商，都变成了 Gitee：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233316.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("还有一些作者的引流、打赏二维码清一色都变成了 Gitee 图标，这就直接影响到作者的收入了！（一天了，作者还没发现）")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233360.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("还有同学的博客变成了这样。。。")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233371.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("于是我先去网上简单调研了一下，有不少小伙伴都遇到了这个问题，那估计就是官方的锅了。")]),t._v(" "),a("p",[t._v("然后我进入 Gitee，找到自己之前搭建的图床仓库（专门用来存放图片的代码仓库），随便找到一张图片，先进入图片查看页（路径包含 blob），然后点击原始数据查看原图：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233402.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("通过跳转的方式是能够顺利打开图片的（原图页面的地址不包含 blob）：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233851.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("然后我直接复制图片的地址，刷新页面，结果就看不到图片了。按 F12 来监听网络请求，发现图片请求并没有得到正确的响应，反而得到了一个 favicon.ico：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233822.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("猜一猜就知道了，这个 ico 文件果然就是 Gitee 的图标！")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233839.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("那为什么从 Gitee 自己的页面跳转到真实图片地址就能显示出图片，直接访问地址就会被拦截呢？")]),t._v(" "),a("p",[t._v("显然是 Gitee 给图片添加了 "),a("strong",[t._v("防盗链")]),t._v(" ，一般情况下，服务端会从客户端的请求头中读取 Referer，通过判断 referer 头是否在白名单中，来决定正常响应图片还是拦截。")]),t._v(" "),a("p",[t._v("为了验证这点，再做个实验。先用 Firefox 浏览器直接打开 Gitee 图片的真实地址，果然无法显示：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233847.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("然后我们在 F12 开发者工具中找到刚刚的图片请求，点击编辑并重发：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233873.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("然后给之前的请求补充上一个 Referer，表示从哪个页面跳转到了目标页面：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233000.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("果然，图片就成功响应了：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233290.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("看来，Gitee 这波真的是加了防盗链，事先没有一点儿通知（直到我发文前，也没有通知）。大家纷纷表示傻眼了：")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233350.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("那既然事情已经发生了，无论 Gitee 官方到底是临时还是永久添加了防盗链，我都不建议大家继续使用 Gitee 作为图床（本身它还有 1 M 图片大小的限制）。而是应该使用七牛云、或者腾讯 / 阿里等云服务厂商提供的稳定的对象存储服务。")]),t._v(" "),a("p",[t._v("很早之前写过一篇图床搭建教程："),a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzI1NDczNTAwMA==&mid=2247483894&idx=1&sn=7291fead256beeaba78e90bd8b046c96&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("《使用 Typora + PicGo 提升百倍写作效率》"),a("OutboundLink")],1),t._v(" ，大家感兴趣可以阅读一下。")]),t._v(" "),a("p",[t._v("对于目前已经受 Gitee 影响的小伙伴，可以做以下几件事：")]),t._v(" "),a("ol",[a("li",[t._v("找到新的对象存储服务")]),t._v(" "),a("li",[t._v("把 Gitee 仓库的代码打包下载并完整上传到新的对象存储服务中（保证路径一致）")]),t._v(" "),a("li",[t._v("使用文本编辑器将图片的链接前缀（gitee.com/xxx）批量替换成新的存储服务链接前缀")])]),t._v(" "),a("p",[t._v("唉，想想都麻烦。。。所以条件允许的话，还是建议大家把图片存到自己的服务器（对象存储服务），更安全放心一些。")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("我也给自己 "),a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzI1NDczNTAwMA==&mid=2247505617&idx=1&sn=73c5e2b1ad9b22d93e8fd6153199ab22&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("编程知识星球"),a("OutboundLink")],1),t._v(" 内的小伙伴建设了一个 "),a("strong",[t._v("免费高速灵活")]),t._v(" 的图床（使用腾讯云 COS），帮助大家省去自己搭建的时间和金钱成本。")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233366.png",loading:"lazy"}})]),t._v(" "),a("p",[t._v("星球内还有更多服务，欢迎大家加入我的星球，和 "),a("strong",[t._v("4000 多名")]),t._v(" 小伙伴们一起交流学习，向鱼皮等大厂同学 1 对 1 提问、跟着鱼皮直播做项目（历史直播回放可无限回看）、领取精心整理的编程资源等。点击文末阅读原文可详细了解。")]),t._v(" "),a("p",[t._v("星球即将涨价，现在加入限时优惠 "),a("strong",[t._v("60 元")]),t._v(" ，欢迎想学习编程、获得进步的小伙伴~")]),t._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311091233435.png",loading:"lazy"}})])])}),[],!1,null,null,null);a.default=p.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{403:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"springboot-é¡¹ç›®ä¸­å¿«é€Ÿå¼•å…¥-rabbit-mq-é€šç”¨åšæ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#springboot-é¡¹ç›®ä¸­å¿«é€Ÿå¼•å…¥-rabbit-mq-é€šç”¨åšæ³•"}},[s._v("#")]),s._v(" SpringBoot é¡¹ç›®ä¸­å¿«é€Ÿå¼•å…¥ Rabbit MQ é€šç”¨åšæ³•")]),s._v(" "),t("blockquote",[t("p",[s._v("ä½œè€…ï¼š"),t("a",{attrs:{href:"https://wx.zsxq.com/dweb2/index/footprint/185541482828452",target:"_blank",rel:"noopener noreferrer"}},[s._v("å°ä½•åŒå­¦"),t("OutboundLink")],1),s._v("ï¼Œ"),t("a",{attrs:{href:"https://wx.zsxq.com/dweb2/index/group/51122858222824",target:"_blank",rel:"noopener noreferrer"}},[s._v("ç¼–ç¨‹å¯¼èˆªæ˜Ÿçƒ"),t("OutboundLink")],1),s._v(" ç¼–å· 18055")])]),s._v(" "),t("h2",{attrs:{id:"â­ç”±æ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#â­ç”±æ¥"}},[s._v("#")]),s._v(" â­ç”±æ¥")]),s._v(" "),t("p",[s._v("æœ¬ç¯‡æ˜¯åœ¨åš"),t("strong",[s._v("BIé¡¹ç›®")]),s._v("æ—¶å°è¯•"),t("strong",[s._v("å¼•å…¥MQ")]),s._v("æ¥ä¼˜åŒ–é¡¹ç›®æ—¶å‘ç°ï¼Œ"),t("strong",[s._v("MQå¼•å…¥åˆ°é¡¹ç›®ä¸­åšæ³•æ¯”è¾ƒç±»ä¼¼")]),s._v("ã€‚å˜çš„åªæ˜¯è°å‘æ¶ˆæ¯ç»™è°ï¼Œè°å»ç›‘å¬æ¶ˆæ¯ã€‚è‡³äºMQçš„å¯é æ€§ï¼ˆæ¯”å¦‚ç”Ÿäº§è€…å¯é æ€§ã€æ¶ˆè´¹è€…å¯é æ€§ã€æ¶ˆæ¯å¯é æ€§ï¼‰éƒ½æ˜¯é€šè¿‡å›ºå®šå‚æ•°è¿›è¡Œé…ç½®ã€‚")]),s._v(" "),t("p",[s._v("å› æ­¤å°†å¼•å…¥MQåˆ°BIé¡¹ç›®çš„è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼Œå˜æˆé€šç”¨çš„æ–¹æ³•ï½")]),s._v(" "),t("h2",{attrs:{id:"ğŸ”¶å¼•å…¥mqç›®çš„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”¶å¼•å…¥mqç›®çš„"}},[s._v("#")]),s._v(" ğŸ”¶å¼•å…¥MQç›®çš„")]),s._v(" "),t("p",[s._v("ç æ‰è€—æ—¶ä¹…çš„ä¸šåŠ¡ï¼Œç¼©çŸ­å•ä¸ªä¸šåŠ¡æ—¶é—´ï¼Œç›‘å¬è€…å¼‚æ­¥æ‰§è¡Œè€—æ—¶ä¹…ä»»åŠ¡")]),s._v(" "),t("p",[s._v("åšå®Œä¹‹åï¼Œä½ å¯ä»¥å®Œæˆspringbooté¡¹ç›®ä¸­MQåŸºæœ¬é…ç½®ï¼Œå¹¶ä¸”MQå…·æœ‰ä¸€å®šå¯é æ€§~ğŸ˜€")]),s._v(" "),t("h2",{attrs:{id:"â­•æ­¥éª¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#â­•æ­¥éª¤"}},[s._v("#")]),s._v(" â­•æ­¥éª¤")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("åœ¨Applicationä¸­é…ç½®MQ")])]),s._v(" "),t("li",[t("ol",[t("li",[s._v("ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ï¼Œé‡è¿æœºåˆ¶ã€æ¶ˆè´¹è€…èƒ½è€…å¤šåŠ³ã€ç¡®è®¤æœºåˆ¶ã€å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥")]),s._v(" "),t("li",[s._v("ä¿è¯å¯é æ€§ï¼ˆé…å¤‡äº†ç”Ÿäº§è€…ç¡®è®¤ï¼Œé‡è¿ã€æ¶ˆè´¹è€…èƒ½è€…å¤šåŠ³ï¼Œç¡®è®¤æœºåˆ¶ï¼Œå¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥ï¼‰")])])])]),s._v(" "),t("p",[s._v("*"),t("strong",[s._v("æ³¨æ„ï¼šä¸æ¸…æ¥šçš„å»ºè®®å­¦ä¹ åé…ç½®ï¼Œä¸è¦ç›´æ¥å¤åˆ¶ï¼ŒæŒ‰éœ€è®¾ç½®~*")])]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v("spring:\n\trabbitmq:\n\t  # è¿æ¥ä¿¡æ¯\n\t  host: xxx # ä½ çš„IPåœ°å€\n\t  port: 5672\n  \t# ç”¨æˆ·ç›¸å…³ä¿¡æ¯å»ºè®®åœ¨rabbitMQä¸­è®¾ç½®å¥½\n\t  virtual-host: /bi # å¯åœ¨UIç•Œé¢åˆ›å»ºç‹¬å±é¡¹ç›®çš„è™šæ‹Ÿæœºä¸ç”¨æˆ·å\n\t  username: xxx # ç”¨æˆ·å\n\t  password: xxx # å¯†ç \n\t  connection-timeout: 200ms # max waited time\n\t\n\t  # ç”Ÿäº§è€…ï¼ˆæ¶ˆæ¯å‘é€è€…ï¼‰\n\t  # ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ - é»˜è®¤å–æ¶ˆï¼Œæ¶ˆè€—æ€§èƒ½\n\t  publisher-confirm-type: none\n\t  publisher-returns: false\n\t  template:\n\t    # ç”Ÿäº§è€…é‡è¿æœºåˆ¶\n\t    retry:\n\t      enabled: true\n\t      initial-interval: 1000ms\n\t      multiplier: 1\n\t      max-attempts: 3\n\t\n\t  # æ¶ˆè´¹è€…ï¼ˆç›‘å¬è€…ï¼‰\n\t  listener:\n\t    simple:\n\t      prefetch: 1 # ï¼ˆèƒ½è€…å¤šåŠ³ï¼‰æ¯æ¬¡åªèƒ½è·å–ä¸€æ¡ä¿¡æ¯ï¼Œå¤„ç†å®Œæ‰èƒ½è·å–ä¸‹ä¸€æ¡\n\t      acknowledge-mode: auto # æ¶ˆè´¹è€…ç¡®è®¤ - è‡ªåŠ¨æ¨¡å¼\n\t      retry:\n\t        enabled: true # å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥\n/**\n * å¤±è´¥è€…æ¶ˆæ¯å¤„ç†ç­–ç•¥å®ç°\n */\n@Bean\npublic MessageRecoverer messageRecoverer(RabbitTemplate rabbitTemplate){\n    return new RepublishMessageRecoverer(rabbitTemplate, BI_ERROR_EXCHANGE, BI_ERROR_ROUTING_KEY);\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("ol",[t("li",[t("p",[s._v("ç»Ÿä¸€ç¡®å®šå¹¶å®šä¹‰ä¸šåŠ¡çš„æœ‰å…³MQå¸¸é‡ "),t("code",[s._v("MQConstant.java")])])]),s._v(" "),t("li",[t("ol",[t("li",[s._v("äº¤æ¢æœºã€é˜Ÿåˆ—ã€Key")]),s._v(" "),t("li",[s._v("erroräº¤æ¢æœºï¼Œé˜Ÿåˆ—ï¼ŒKeyï¼ˆ"),t("em",[s._v("æŒ‰éœ€è®¾ç½®")]),s._v("ï¼‰")])])]),s._v(" "),t("li",[t("p",[s._v("å¼€å§‹åˆå§‹åŒ–")])]),s._v(" "),t("li",[t("ol",[t("li",[s._v("ä¸šåŠ¡MQ ä¸ erroräº¤æ¢æœºMQï¼Œå¹¶ç»‘å®šå…³ç³»ï¼ˆé€‰ä¸€ä¸ªå°±è¡Œï¼Œæ¨èç¬¬äºŒç§ï¼‰")])])])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Configuration")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ErrorConfiguration")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Queue")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("errorQueue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("QueueBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("durable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_ERROR_QUEUE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DirectExchange")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("errorExchange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExchangeBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("directExchange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_ERROR_EXCHANGE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Binding")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("errorBinding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BindingBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("errorQueue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("errorExchange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_ERROR_ROUTING_KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RabbitListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bindings "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@QueueBinding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é˜Ÿåˆ—ï¼š")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// name - é˜Ÿåˆ—åå­—")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// durable - é˜Ÿåˆ—æŒä¹…åŒ–ï¼Œä¸ä¼šéšç€MQå…³é—­è€Œæ¶ˆå¤±")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// argumentsï¼šä½¿é˜Ÿåˆ—ä¸ºLazy queueå°†æ¶ˆæ¯å°½å¿«å†™å…¥ç£ç›˜")]),s._v("\n        value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Queue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_QUEUE_NAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                durable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                arguments "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Argument")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-queue-mode"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lazy"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// äº¤æ¢æœº:æŒ‡å®šäº¤æ¢æœºçš„åå­—ä¸ç±»å‹(é»˜è®¤direct)")]),s._v("\n        exchange "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Exchange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_EXCHANGE_NAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExchangeTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DIRECT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŒ‰äº¤æ¢æœºç±»å‹(Directã€Topic),è®¾ç½®Key")]),s._v("\n        key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_ROUTING_KEY")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("receiveMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("ol",[t("li",[t("ol",[t("li",[s._v("JSONæ¶ˆæ¯è½¬æ¢å™¨ï¼ˆæ›¿æ¢æ‰åŸç”Ÿçš„JDKï¼‰")])])])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * æ¶ˆæ¯è½¬æ¢å™¨\n * @return\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MessageConverter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("messageConverter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jackson2JsonMessageConverter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ol",[t("li",[t("p",[s._v("ç¼–å†™ä¸šåŠ¡ä»£ç ï¼ˆæ ¹æ®å®é™…ä¸šåŠ¡ï¼‰")])]),s._v(" "),t("li",[t("ol",[t("li",[s._v("å‘é€ä¿¡æ¯ï¼šç æ‰è€—æ—¶ä¹…çš„ä¸šåŠ¡ï¼Œå˜æˆå‘é€æ¶ˆæ¯")])])]),s._v(" "),t("li",[t("ol",[t("li",[t("ol",[t("li",[s._v("é€‰ç”¨å”¯ä¸€æ€§çš„ä¿¡æ¯ï¼Œå¦‚id")]),s._v(" "),t("li",[s._v("ç¡®å®šå¥½æ¶ˆæ¯çš„æ•°æ®ç±»å‹")])])])])]),s._v(" "),t("li",[t("ol",[t("li",[s._v("ç›‘å¬ä¿¡æ¯ï¼šæ·»åŠ ç›‘å¬è€…ï¼Œæ‰§è¡Œè€—æ—¶ä¹…çš„ä¸šåŠ¡ã€‚")])])]),s._v(" "),t("li",[t("ol",[t("li",[t("ol",[t("li",[s._v("éœ€è¦æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ä»£ç ")]),s._v(" "),t("li",[s._v("å¯ä»¥æ ¹æ®ä¸šåŠ¡å®é™…æƒ…å†µä½¿ï¼š"),t("strong",[s._v("ä¸šåŠ¡å¹‚ç­‰æ€§")])])])])])])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RabbitListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bindings "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@QueueBinding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é˜Ÿåˆ—ï¼š")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// name - é˜Ÿåˆ—åå­—")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// durable - é˜Ÿåˆ—æŒä¹…åŒ–ï¼Œä¸ä¼šéšç€MQå…³é—­è€Œæ¶ˆå¤±")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// argumentsï¼šä½¿é˜Ÿåˆ—ä¸ºLazy queueå°†æ¶ˆæ¯å°½å¿«å†™å…¥ç£ç›˜")]),s._v("\n        value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Queue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_QUEUE_NAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                durable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                arguments "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Argument")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-queue-mode"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lazy"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// äº¤æ¢æœº:æŒ‡å®šäº¤æ¢æœºçš„åå­—ä¸ç±»å‹(é»˜è®¤direct)")]),s._v("\n        exchange "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Exchange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_EXCHANGE_NAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExchangeTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DIRECT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŒ‰äº¤æ¢æœºç±»å‹(Directã€Topic),è®¾ç½®Key")]),s._v("\n        key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BI_ROUTING_KEY")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("receiveMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" chatId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0. ä¸šåŠ¡å¹‚ç­‰æ€§åˆ¤æ–­ - åŸºäºä¹è§‚é”æ”¹é€ ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" update "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" chartService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lambdaUpdate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Chart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUNNING_STATUS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("eq")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Chart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" chatId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("eq")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Chart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WAIT_STATUS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("update"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("handleChartUpdateError")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("chatId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"è¯¥å›¾è¡¨æ­£åœ¨ç”Ÿæˆä¸­ï¼è¯·è€å¿ƒç­‰å¾…"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("å½“ç„¶ï¼Œè¿˜å¯ä»¥å¯¹å…¶è¿›è¡Œæ‹“å±•ï¼Œæ¯”å¦‚å¯¹erroré˜Ÿåˆ—è¿›è¡Œç›‘å¬ï¼Œé’ˆå¯¹é”™è¯¯æ¶ˆæ¯è¿›è¡Œç‰¹æ®Šä¸šåŠ¡å¤„ç†ç­‰ç­‰~")]),s._v(" "),t("p",[s._v("è‡³æ­¤ä¹‹åï¼ŒMQåŸºæœ¬æ“ä½œä»¥åŠé…ç½®å®Œæ¯•~å¹¶ä¸”MQå¯é æ€§ç›¸å¯¹é«˜ã€‚")]),s._v(" "),t("p",[s._v("æœ€åï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç”¨~")])])}),[],!1,null,null,null);t.default=e.exports}}]);
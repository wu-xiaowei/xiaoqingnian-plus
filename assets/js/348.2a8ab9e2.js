(window.webpackJsonp=window.webpackJsonp||[]).push([[348],{652:function(a,s,t){"use strict";t.r(s);var e=t(4),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"如何去除字符串中的-n"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何去除字符串中的-n"}},[a._v("#")]),a._v(' 如何去除字符串中的 "\\n" ？')]),a._v(" "),s("blockquote",[s("p",[a._v("本文作者："),s("a",{attrs:{href:"https://yuyuanweb.feishu.cn/wiki/Abldw5WkjidySxkKxU2cQdAtnah",target:"_blank",rel:"noopener noreferrer"}},[a._v("程序员鱼皮"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("本站地址："),s("a",{attrs:{href:"https://codefather.cn",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://codefather.cn"),s("OutboundLink")],1)])]),a._v(" "),s("p",[a._v("大家好，我是鱼皮，今天分享一个小知识。")]),a._v(" "),s("p",[a._v("我最近负责的工作是设计一个 SQL 解析引擎。简单来说，就是将一个 SQL 表达式字符串，解析为一颗对象树，从而执行查询等一系列操作。")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005215.png",loading:"lazy"}})]),a._v(" "),s("blockquote",[s("p",[a._v("SQL 解析原理")])]),a._v(" "),s("p",[a._v("在最开始，我就遇到了一个很头疼的问题，"),s("strong",[a._v("用户编写的 SQL 语句可能非常不标准！")])]),a._v(" "),s("p",[a._v("理想的 SQL 语句，缩进很规范，没有多余的字符：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("select * from user;\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("而现实往往是这样的：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v(" select * \\n\nfrom   user;\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("上述语句不仅缩进、换行很随意，还多了很多无意义的字符串，比如 "),s("code",[a._v('"\\n"')]),a._v(" ！")]),a._v(" "),s("p",[a._v("因此，想要设计一个通用性强的 SQL 解析引擎，首先要对字符串进行 "),s("strong",[a._v("预处理")]),a._v("，将输入的 SQL 语句标准化。比如去除回车、换行、冗余的空格和特殊字符等。")]),a._v(" "),s("p",[a._v("那问题来了，如何去除字符串中的所有 "),s("code",[a._v('"\\n"')]),a._v(" 呢？注意，这里的 "),s("code",[a._v('"\\n"')]),a._v(" "),s("strong",[a._v("并不是换行符")]),a._v("，而是由字符 "),s("code",[a._v("'\\'")]),a._v(" 和字符 "),s("code",[a._v("'n'")]),a._v(" 组成的字符串！")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# 转换前\nselect * \\n \nfrom user;\n\n# 转换后\nselect * from user;\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("p",[a._v("首先我想到了两种思路：")]),a._v(" "),s("ol",[s("li",[a._v("用循环语句顺序扫描每个字符，通过当前字符和下一个字符判断是否为 "),s("code",[a._v('"\\n"')]),a._v("，再移除。")]),a._v(" "),s("li",[a._v("直接用 Java 语言提供的 "),s("code",[a._v("replaceAll")]),a._v(" 方法，传入一个正则表达式，直接将完整字符串中所有匹配正则的子串替换为空串。")])]),a._v(" "),s("p",[a._v("我这里选择后者，直接用现成的方法会比较方便，而且借助强大的正则表达式，可以同时替换掉多个冗余字符。")]),a._v(" "),s("p",[a._v("Java 正则表达式定义：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("/*\n * 全部替换\n * regex 正则表达式\n * replacement 要替换成的新串\n */\npublic String replaceAll(String regex, String replacement) {\n  return Pattern.compile(regex).matcher(this).replaceAll(replacement);\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("p",[a._v("那么如何编写正则表达式，移除所有的 "),s("code",[a._v('"\\n"')]),a._v(" 呢？大家可以先自己想一下，欢迎参与投票~")]),a._v(" "),s("p",[a._v('如何用正则表达式移除所有的 "\\n" 呢？')]),a._v(" "),s("p",[a._v("刚开始我想的太简单了，直接编写出如下代码：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('str.replaceAll("\\n", "");\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("结果，并不能顺利地替换掉字符串中的 "),s("code",[a._v('"\\n"')]),a._v("，仅仅是把换行符去掉了！")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005124.png",loading:"lazy"}}),a._v("用单个反斜杠的结果")]),a._v(" "),s("p",[a._v("原因很简单，在 Java 字符常量中，反斜杠（\\）是一个特殊的字符，被称为 "),s("strong",[a._v("转义字符")]),a._v("，它的作用是用来转义后面一个字符，本身不具有实际意义!")]),a._v(" "),s("p",[a._v("因此，不能用下面这种方式直接输出反斜杠：")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005140.png",loading:"lazy"}})]),a._v(" "),s("blockquote",[s("p",[a._v("报错")])]),a._v(" "),s("p",[a._v("如果想要单独输出一个反斜杠，需要再加上一个反斜杠转义：")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005138.png",loading:"lazy"}})]),a._v(" "),s("blockquote",[s("p",[a._v("无报错")])]),a._v(" "),s("p",[a._v("同理，想要输出一个 "),s("code",[a._v('"\\n"')]),a._v(" 字符串，代码要这么写：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('System.out.println("\\\\n")\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("那不妨试试这个正则表达式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('str.replaceAll("\\\\n", "");\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("结果出乎意料，竟然和只用一个反斜杠时的效果一样！仅仅是移除了换行符。")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005124.png",loading:"lazy"}})]),a._v(" "),s("blockquote",[s("p",[a._v("用两个反斜杠的效果")])]),a._v(" "),s("p",[a._v("其实，正确的答案应该是使用 "),s("strong",[a._v("四个反斜杠")]),a._v("，因为反斜杠在 Java 和正则表达式中都是转义字符！")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005136.jpeg",loading:"lazy"}})]),a._v(" "),s("p",[a._v("其中，第一个斜杠是转义符，第二个斜杠是斜杠本身，第三个斜杠又是转义符，第四个斜杠是斜杠本身。")]),a._v(" "),s("p",[a._v("在 Java 中，输出 "),s("code",[a._v('"\\n"')]),a._v(" 字符串需要两个反斜杠和一个 "),s("code",[a._v("'n'")]),a._v("，在 Java 的正则表达式中，要给这两个反斜杠分别再分配一个反斜杠进行转义，才能生效。")]),a._v(" "),s("p",[a._v("总而言之，记住一句话："),s("strong",[a._v("Java 正则表达式中，匹配一个反斜杠要用四个反斜杠！")])]),a._v(" "),s("hr"),a._v(" "),s("p",[a._v("最后，正则表达式可是一门大学问，推荐一款学习、创建和测试正则表达式的在线可视化工具，"),s("strong",[a._v("RegExr")]),a._v("。通过练习的方式学习，很快就能入门啦！")]),a._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202311072005167.png",loading:"lazy"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);
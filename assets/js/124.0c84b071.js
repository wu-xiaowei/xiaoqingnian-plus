(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{420:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ä»€ä¹ˆæ˜¯æ¥å£çš„å¹‚ç­‰æ€§-å¦‚ä½•ä¿è¯æ¥å£çš„å¹‚ç­‰æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯æ¥å£çš„å¹‚ç­‰æ€§-å¦‚ä½•ä¿è¯æ¥å£çš„å¹‚ç­‰æ€§"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯æ¥å£çš„å¹‚ç­‰æ€§ï¼Œå¦‚ä½•ä¿è¯æ¥å£çš„å¹‚ç­‰æ€§ï¼Ÿ")]),s._v(" "),t("blockquote",[t("p",[s._v("ä½œè€…ï¼š"),t("a",{attrs:{href:"https://wx.zsxq.com/dweb2/index/footprint/581115115488824",target:"_blank",rel:"noopener noreferrer"}},[s._v("Leo"),t("OutboundLink")],1),s._v("ï¼Œ"),t("a",{attrs:{href:"https://wx.zsxq.com/dweb2/index/group/51122858222824",target:"_blank",rel:"noopener noreferrer"}},[s._v("ç¼–ç¨‹å¯¼èˆªæ˜Ÿçƒ"),t("OutboundLink")],1),s._v(" ç¼–å· 12644")])]),s._v(" "),t("h2",{attrs:{id:"_1-å‰è¨€â˜•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å‰è¨€â˜•"}},[s._v("#")]),s._v(" 1.å‰è¨€â˜•")]),s._v(" "),t("p",[s._v("å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Leoå“¥ğŸ«£ğŸ«£ğŸ«£ï¼Œåˆ†äº«ä¸€ä¸‹å…³äºæ¥å£çš„å¹‚ç­‰æ€§çš„åšå®¢ã€‚")]),s._v(" "),t("h2",{attrs:{id:"_2-ä»€ä¹ˆæ˜¯å¹‚ç­‰æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä»€ä¹ˆæ˜¯å¹‚ç­‰æ€§"}},[s._v("#")]),s._v(" 2.ä»€ä¹ˆæ˜¯å¹‚ç­‰æ€§")]),s._v(" "),t("p",[s._v("å¹‚ç­‰æ˜¯ä¸€ä¸ªæ•°å­¦ä¸è®¡ç®—æœºå­¦æ¦‚å¿µï¼Œåœ¨æ•°å­¦ä¸­æŸä¸€å…ƒè¿ç®—ä¸ºå¹‚ç­‰æ—¶ï¼Œå…¶ä½œç”¨åœ¨ä»»ä¸€å…ƒç´ ä¸¤æ¬¡åä¼šå’Œå…¶ä½œç”¨ä¸€æ¬¡çš„ç»“æœç›¸åŒã€‚åœ¨è®¡ç®—æœºä¸­ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªå¹‚ç­‰æ“ä½œçš„ç‰¹ç‚¹æ˜¯å…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œæ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚å¹‚ç­‰å‡½æ•°æˆ–å¹‚ç­‰æ–¹æ³•æ˜¯æŒ‡å¯ä»¥ä½¿ç”¨ç›¸åŒå‚æ•°é‡å¤æ‰§è¡Œï¼Œå¹¶èƒ½è·å¾—ç›¸åŒç»“æœçš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°ä¸ä¼šå½±å“ç³»ç»ŸçŠ¶æ€ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒé‡å¤æ‰§è¡Œä¼šå¯¹ç³»ç»Ÿé€ æˆæ”¹å˜ã€‚")]),s._v(" "),t("h2",{attrs:{id:"_3-ä»€ä¹ˆæ˜¯æ¥å£å¹‚ç­‰æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-ä»€ä¹ˆæ˜¯æ¥å£å¹‚ç­‰æ€§"}},[s._v("#")]),s._v(" 3.ä»€ä¹ˆæ˜¯æ¥å£å¹‚ç­‰æ€§")]),s._v(" "),t("p",[s._v("æ‰€è°“æ¥å£å¹‚ç­‰æ€§ï¼Œå°±æ˜¯ä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€ä¸ªèµ„æºå¯¹äºèµ„æºæœ¬èº«åº”è¯¥å…·æœ‰åŒæ ·çš„ç»“æœã€‚")]),s._v(" "),t("p",[s._v("æ¥å£çš„ "),t("strong",[s._v("å¹‚ç­‰æ€§ï¼ˆIdempotenceï¼‰")]),s._v(" æ˜¯æŒ‡"),t("code",[s._v("ä¸€ä¸ªæ“ä½œåœ¨æ‰§è¡Œä¸€æ¬¡å’Œå¤šæ¬¡æ‰§è¡Œæ—¶ï¼Œå…¶ç»“æœæ˜¯ä¸€æ ·çš„")]),s._v("ã€‚æ¢å¥è¯è¯´ï¼Œæ— è®ºè¿™ä¸ªæ“ä½œè¢«æ‰§è¡Œå¤šå°‘æ¬¡ï¼Œå®ƒå¯¹ç³»ç»ŸçŠ¶æ€çš„å½±å“éƒ½æ˜¯ç›¸åŒçš„ã€‚å¹‚ç­‰æ€§æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒæœ‰åŠ©äºç¡®ä¿ç³»ç»Ÿçš„å¥å£®æ€§å’Œä¸€è‡´æ€§ã€‚")]),s._v(" "),t("p",[s._v("åœ¨ç½‘ç»œé€šä¿¡å’Œ API è®¾è®¡ä¸­ï¼Œå¹‚ç­‰æ€§å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥é˜²æ­¢ç”±äºç½‘ç»œé‡ä¼ ã€å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ç«¯çš„é‡å¤è¯·æ±‚ç­‰é—®é¢˜å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¹‚ç­‰çš„ HTTP è¯·æ±‚ï¼ˆå¦‚ GET æˆ– PUT è¯·æ±‚ï¼‰åœ¨å¤šæ¬¡å‘é€æ—¶ï¼ŒæœåŠ¡å™¨åº”è¯¥èƒ½å¤Ÿæ­£ç¡®å¤„ç†ï¼Œç¡®ä¿ä¸ä¼šå¯¹èµ„æºé€ æˆæ„å¤–çš„å½±å“ã€‚")]),s._v(" "),t("h2",{attrs:{id:"_4-åº”ç”¨åœºæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-åº”ç”¨åœºæ™¯"}},[s._v("#")]),s._v(" 4.åº”ç”¨åœºæ™¯")]),s._v(" "),t("p",[s._v("ä¸çŸ¥é“ä»¥ä¸‹åœºæ™¯ï¼Œæœ‹å‹ä»¬æ˜¯å¦é‡åˆ°è¿‡ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("å‰ç«¯é‡å¤æäº¤è¡¨å•ï¼š")]),s._v(" åœ¨å¡«å†™ä¸€äº›è¡¨æ ¼æ—¶å€™ï¼Œç”¨æˆ·å¡«å†™å®Œæˆæäº¤ï¼Œå¾ˆå¤šæ—¶å€™ä¼šå› ç½‘ç»œæ³¢åŠ¨æ²¡æœ‰åŠæ—¶å¯¹ç”¨æˆ·åšå‡ºæäº¤æˆåŠŸå“åº”ï¼Œè‡´ä½¿ç”¨æˆ·è®¤ä¸ºæ²¡æœ‰æˆåŠŸæäº¤ï¼Œç„¶åä¸€ç›´ç‚¹æäº¤æŒ‰é’®ï¼Œè¿™æ—¶å°±ä¼šå‘ç”Ÿé‡å¤æäº¤è¡¨å•è¯·æ±‚ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ç”¨æˆ·æ¶æ„è¿›è¡Œåˆ·å•ï¼š")]),s._v(" ä¾‹å¦‚åœ¨å®ç°ç”¨æˆ·æŠ•ç¥¨è¿™ç§åŠŸèƒ½æ—¶ï¼Œå¦‚æœç”¨æˆ·é’ˆå¯¹ä¸€ä¸ªç”¨æˆ·è¿›è¡Œé‡å¤æäº¤æŠ•ç¥¨ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ¥å£æ¥æ”¶åˆ°ç”¨æˆ·é‡å¤æäº¤çš„æŠ•ç¥¨ä¿¡æ¯ï¼Œè¿™æ ·ä¼šä½¿æŠ•ç¥¨ç»“æœä¸äº‹å®ä¸¥é‡ä¸ç¬¦ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æ¥å£è¶…æ—¶é‡å¤æäº¤ï¼š")]),s._v(" å¾ˆå¤šæ—¶å€™ HTTP å®¢æˆ·ç«¯å·¥å…·éƒ½é»˜è®¤å¼€å¯è¶…æ—¶é‡è¯•çš„æœºåˆ¶ï¼Œå°¤å…¶æ˜¯ç¬¬ä¸‰æ–¹è°ƒç”¨æ¥å£æ—¶å€™ï¼Œä¸ºäº†é˜²æ­¢ç½‘ç»œæ³¢åŠ¨è¶…æ—¶ç­‰é€ æˆçš„è¯·æ±‚å¤±è´¥ï¼Œéƒ½ä¼šæ·»åŠ é‡è¯•æœºåˆ¶ï¼Œå¯¼è‡´ä¸€ä¸ªè¯·æ±‚æäº¤å¤šæ¬¡ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æ¶ˆæ¯è¿›è¡Œé‡å¤æ¶ˆè´¹ï¼š")]),s._v(" å½“ä½¿ç”¨ MQ æ¶ˆæ¯ä¸­é—´ä»¶æ—¶å€™ï¼Œå¦‚æœå‘ç”Ÿæ¶ˆæ¯ä¸­é—´ä»¶å‡ºç°é”™è¯¯æœªåŠæ—¶æäº¤æ¶ˆè´¹ä¿¡æ¯ï¼Œå¯¼è‡´å‘ç”Ÿé‡å¤æ¶ˆè´¹ã€‚")])]),s._v(" "),t("p",[s._v("æ²¡é”™ï¼Œè¿™äº›éƒ½æ˜¯å¹‚ç­‰æ€§é—®é¢˜ã€‚")]),s._v(" "),t("p",[t("code",[s._v("æ¥å£å¹‚ç­‰æ€§")]),s._v("æ˜¯æŒ‡ç”¨æˆ·å¯¹äºåŒä¸€æ“ä½œå‘èµ·çš„ä¸€æ¬¡è¯·æ±‚æˆ–è€…å¤šæ¬¡è¯·æ±‚çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šå› ä¸ºå¤šæ¬¡ç‚¹å‡»è€Œäº§ç”Ÿäº†å‰¯ä½œç”¨ã€‚")]),s._v(" "),t("p",[s._v("è¿™ç±»é—®é¢˜å¤šå‘äºæ¥å£çš„ï¼š")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("insert")]),s._v("æ“ä½œï¼Œè¿™ç§æƒ…å†µä¸‹å¤šæ¬¡è¯·æ±‚ï¼Œå¯èƒ½ä¼šäº§ç”Ÿé‡å¤æ•°æ®ã€‚")]),s._v(" "),t("li",[t("code",[s._v("update")]),s._v("æ“ä½œï¼Œå¦‚æœåªæ˜¯å•çº¯çš„æ›´æ–°æ•°æ®ï¼Œæ¯”å¦‚ï¼š"),t("code",[s._v("update user set status=1 where id=1")]),s._v("ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚å¦‚æœè¿˜æœ‰è®¡ç®—ï¼Œæ¯”å¦‚ï¼š"),t("code",[s._v("update user set status=status+1 where id=1")]),s._v("ï¼Œè¿™ç§æƒ…å†µä¸‹å¤šæ¬¡è¯·æ±‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®é”™è¯¯ã€‚")])]),s._v(" "),t("h2",{attrs:{id:"_5-è§£å†³æ–¹æ¡ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-è§£å†³æ–¹æ¡ˆ"}},[s._v("#")]),s._v(" 5.è§£å†³æ–¹æ¡ˆ")]),s._v(" "),t("h3",{attrs:{id:"_5-1-insertä¹‹å‰å…ˆselect"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-insertä¹‹å‰å…ˆselect"}},[s._v("#")]),s._v(" 5.1 insertä¹‹å‰å…ˆselect")]),s._v(" "),t("p",[s._v("é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨ä¿å­˜æ•°æ®çš„æ¥å£ä¸­ï¼Œæˆ‘ä»¬ä¸ºäº†é˜²æ­¢äº§ç”Ÿé‡å¤æ•°æ®ï¼Œä¸€èˆ¬ä¼šåœ¨"),t("code",[s._v("insert")]),s._v("å‰ï¼Œå…ˆæ ¹æ®"),t("code",[s._v("name")]),s._v("å­—æ®µ"),t("code",[s._v("select")]),s._v("ä¸€ä¸‹æ•°æ®ã€‚å¦‚æœè¯¥æ•°æ®å·²å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œ"),t("code",[s._v("update")]),s._v("æ“ä½œï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œæ‰æ‰§è¡Œ "),t("code",[s._v("insert")]),s._v("æ“ä½œã€‚")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319418.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"_5-2-æ•°æ®åº“å”¯ä¸€ç´¢å¼•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-æ•°æ®åº“å”¯ä¸€ç´¢å¼•"}},[s._v("#")]),s._v(" 5.2 æ•°æ®åº“å”¯ä¸€ç´¢å¼•")]),s._v(" "),t("p",[s._v("å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ºäº†é˜²æ­¢æ•°æ®é‡å¤æäº¤ï¼Œæˆ‘ä»¬éƒ½ä¼šåœ¨è¡¨ä¸­æ·»åŠ å”¯ä¸€ç´¢å¼•ï¼Œè¿™ä¸ªä¸€ä¸ªéå¸¸ç®€å•è€Œä¸”æœ‰å¥‡æ•ˆçš„æ–¹æ¡ˆã€‚")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("t_code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("åŠ äº†å”¯ä¸€ç´¢å¼•ä¹‹åï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚æ•°æ®å¯ä»¥æ’å…¥æˆåŠŸã€‚ä½†åé¢çš„ç›¸åŒè¯·æ±‚ï¼Œæ’å…¥æ•°æ®æ—¶ä¼šæŠ¥"),t("code",[s._v("Duplicate entry '002' for key 'order.t_code")]),s._v("å¼‚å¸¸ï¼Œè¡¨ç¤ºå”¯ä¸€ç´¢å¼•æœ‰å†²çªã€‚")]),s._v(" "),t("p",[t("strong",[s._v("å…·ä½“æµç¨‹å›¾å¦‚ä¸‹ï¼š")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319369.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"_5-3-tokenæœºåˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-tokenæœºåˆ¶"}},[s._v("#")]),s._v(" 5.3 Tokenæœºåˆ¶")]),s._v(" "),t("p",[s._v("é’ˆå¯¹å®¢æˆ·ç«¯è¿ç»­ç‚¹å‡»æˆ–è€…è°ƒç”¨æ–¹çš„è¶…æ—¶é‡è¯•ç­‰æƒ…å†µï¼Œä¾‹å¦‚æäº¤è®¢å•ï¼Œæ­¤ç§æ“ä½œå°±å¯ä»¥ç”¨ Token çš„æœºåˆ¶å®ç°é˜²æ­¢é‡å¤æäº¤ã€‚ç®€å•çš„è¯´å°±æ˜¯è°ƒç”¨æ–¹åœ¨è°ƒç”¨æ¥å£çš„æ—¶å€™å…ˆå‘åç«¯è¯·æ±‚ä¸€ä¸ªå…¨å±€ IDï¼ˆTokenï¼‰ï¼Œè¯·æ±‚çš„æ—¶å€™æºå¸¦è¿™ä¸ªå…¨å±€ ID ä¸€èµ·è¯·æ±‚**ï¼ˆToken æœ€å¥½å°†å…¶æ”¾åˆ° Headers ä¸­ï¼‰**ï¼Œåç«¯éœ€è¦å¯¹è¿™ä¸ª Token ä½œä¸º Keyï¼Œç”¨æˆ·ä¿¡æ¯ä½œä¸º Value åˆ° Redis ä¸­è¿›è¡Œé”®å€¼å†…å®¹æ ¡éªŒï¼Œå¦‚æœ Key å­˜åœ¨ä¸” Value åŒ¹é…å°±æ‰§è¡Œåˆ é™¤å‘½ä»¤ï¼Œç„¶åæ­£å¸¸æ‰§è¡Œåé¢çš„ä¸šåŠ¡é€»è¾‘ã€‚å¦‚æœä¸å­˜åœ¨å¯¹åº”çš„ Key æˆ– Value ä¸åŒ¹é…å°±è¿”å›é‡å¤æ‰§è¡Œçš„é”™è¯¯ä¿¡æ¯ï¼Œè¿™æ ·æ¥ä¿è¯å¹‚ç­‰æ“ä½œã€‚")]),s._v(" "),t("p",[s._v("è¯¥æ–¹æ¡ˆè·Ÿä¹‹å‰çš„æ‰€æœ‰æ–¹æ¡ˆéƒ½æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œéœ€è¦ä¸¤æ¬¡è¯·æ±‚æ‰èƒ½å®Œæˆä¸€æ¬¡ä¸šåŠ¡æ“ä½œã€‚")]),s._v(" "),t("ol",[t("li",[s._v("ç¬¬ä¸€æ¬¡è¯·æ±‚è·å–"),t("code",[s._v("token")])]),s._v(" "),t("li",[s._v("ç¬¬äºŒæ¬¡è¯·æ±‚å¸¦ç€è¿™ä¸ª"),t("code",[s._v("token")]),s._v("ï¼Œå®Œæˆä¸šåŠ¡æ“ä½œã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("å…·ä½“æµç¨‹å›¾å¦‚ä¸‹ï¼š")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319491.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"_5-4-æ‚²è§‚é”æœºåˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-æ‚²è§‚é”æœºåˆ¶"}},[s._v("#")]),s._v(" 5.4 æ‚²è§‚é”æœºåˆ¶")]),s._v(" "),t("p",[s._v("æ¯”å¦‚æŸé“¶è¡Œæœ‰ä¸ªè½¬è´¦åœºæ™¯ï¼Œç”¨æˆ·Aæ‰‹é‡Œæœ‰200å—é’±ï¼Œæƒ³è½¬å‡º100å…ƒï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·Aè½¬è´¦ä¹‹ååªå‰©ä¸‹äº†100å…ƒï¼ŒSQLå¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" amount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" amount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½†æ˜¯å®é™…æƒ…å†µä¸‹ï¼Œå¹¶éå¦‚æ­¤ï¼Œå¦‚æœæœ‰ä¸ªç›¸åŒçš„è¯·æ±‚è¿›æ¥ï¼Œç”¨æˆ·Açš„è´¦æˆ·å°±ä¼šä¸€ç›´æ‰£å‡ï¼Œç›´åˆ°å˜æˆè´Ÿæ•°ã€‚è¿™ç§æƒ…å†µï¼Œç”¨æˆ·Aç›´æ¥å“­æ­»ï¼Œåœ¨ä¸šåŠ¡åœºæ™¯ä¸­ä¹Ÿæ˜¯ä¸å…è®¸å‡ºç°çš„ã€‚")]),s._v(" "),t("p",[s._v("é€šå¸¸æƒ…å†µä¸‹é€šè¿‡å¦‚ä¸‹sqlé”ä½å•è¡Œæ•°æ®ï¼š")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("å…·ä½“æ­¥éª¤ï¼š")])]),s._v(" "),t("ol",[t("li",[s._v("å¤šä¸ªè¯·æ±‚åŒæ—¶æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚")]),s._v(" "),t("li",[s._v("åˆ¤æ–­ä½™é¢æ˜¯å¦ä¸è¶³100ï¼Œå¦‚æœä½™é¢ä¸è¶³ï¼Œåˆ™ç›´æ¥è¿”å›ä½™é¢ä¸è¶³ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœä½™é¢å……è¶³ï¼Œåˆ™é€šè¿‡for updateå†æ¬¡æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”å°è¯•è·å–é”ã€‚")]),s._v(" "),t("li",[s._v("åªæœ‰ç¬¬ä¸€ä¸ªè¯·æ±‚èƒ½è·å–åˆ°è¡Œé”ï¼Œå…¶ä½™æ²¡æœ‰è·å–é”çš„è¯·æ±‚ï¼Œåˆ™ç­‰å¾…ä¸‹ä¸€æ¬¡è·å–é”çš„æœºä¼šã€‚")]),s._v(" "),t("li",[s._v("ç¬¬ä¸€ä¸ªè¯·æ±‚è·å–åˆ°é”ä¹‹åï¼Œåˆ¤æ–­ä½™é¢æ˜¯å¦ä¸è¶³100ï¼Œå¦‚æœä½™é¢è¶³å¤Ÿï¼Œåˆ™è¿›è¡Œupdateæ“ä½œã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœä½™é¢ä¸è¶³ï¼Œè¯´æ˜æ˜¯é‡å¤è¯·æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚")])]),s._v(" "),t("p",[s._v("æ‚²è§‚é”éœ€è¦åœ¨åŒä¸€ä¸ªäº‹åŠ¡æ“ä½œè¿‡ç¨‹ä¸­é”ä½ä¸€è¡Œæ•°æ®ï¼Œå¦‚æœäº‹åŠ¡è€—æ—¶æ¯”è¾ƒé•¿ï¼Œä¼šé€ æˆå¤§é‡çš„è¯·æ±‚ç­‰å¾…ï¼Œå½±å“æ¥å£æ€§èƒ½ã€‚")]),s._v(" "),t("p",[s._v("æ­¤å¤–ï¼Œæ¯æ¬¡è¯·æ±‚æ¥å£å¾ˆéš¾ä¿è¯éƒ½æœ‰ç›¸åŒçš„è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸é€‚åˆå¹‚ç­‰æ€§è®¾è®¡åœºæ™¯ï¼Œä½†æ˜¯åœ¨é˜²é‡åœºæ™¯ä¸­æ˜¯å¯ä»¥çš„ä½¿ç”¨çš„ã€‚")]),s._v(" "),t("h3",{attrs:{id:"_5-5-ä¹è§‚é”æœºåˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-ä¹è§‚é”æœºåˆ¶"}},[s._v("#")]),s._v(" 5.5 ä¹è§‚é”æœºåˆ¶")]),s._v(" "),t("p",[s._v("å› ä¸ºæ‚²è§‚é”æ˜¯æ¯”è¾ƒæ¶ˆè€—çš„æ€§èƒ½çš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºäº†æé«˜æ¥å£æ€§èƒ½ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ä¹è§‚é”ã€‚éœ€è¦å†è¡¨ä¸­æ·»åŠ ä¸€ä¸ªversionå­—æ®µã€‚")]),s._v(" "),t("p",[s._v("æ¯”å¦‚ï¼š")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add")]),s._v(" version "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("ï¼ˆ"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("ï¼‰ï¼›\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("æ¯å½“æˆ‘ä»¬æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦å¯¹æˆ‘ä»¬çš„ç‰ˆæœ¬å·+1")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" amount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" amount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" version "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("æ›´æ–°æ•°æ®çš„åŒæ—¶"),t("code",[s._v("version+1")]),s._v("ï¼Œç„¶ååˆ¤æ–­æœ¬æ¬¡"),t("code",[s._v("update")]),s._v("æ“ä½œçš„å½±å“è¡Œæ•°ï¼Œå¦‚æœå¤§äº0ï¼Œåˆ™è¯´æ˜æœ¬æ¬¡æ›´æ–°æˆåŠŸï¼Œå¦‚æœç­‰äº0ï¼Œåˆ™è¯´æ˜æœ¬æ¬¡æ›´æ–°æ²¡æœ‰è®©æ•°æ®å˜æ›´ã€‚")]),s._v(" "),t("p",[s._v("ç­‰åˆ°ä¸‹ä¸€ä¸ªè¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œä¾ç„¶å›å»æ‰§è¡Œè¿™è¡ŒSQLï¼Œæ­¤æ—¶å‘ç°ï¼Œæ ¹æœ¬ä¸å¯èƒ½æ»¡è¶³ï¼Œ"),t("code",[s._v("version= 1")]),s._v(" è¿™ä¸ªæ¡ä»¶ï¼Œå› ä¸º"),t("code",[s._v("version")]),s._v("å€¼å·²ç»ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå‰é¢å¿…å®šå·²ç»æˆåŠŸè¿‡ä¸€æ¬¡ï¼Œåé¢éƒ½æ˜¯é‡å¤çš„è¯·æ±‚ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("æµç¨‹å›¾å¦‚ä¸‹ï¼š")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319382.png",loading:"lazy"}})]),s._v(" "),t("p",[t("strong",[s._v("å…·ä½“æ­¥éª¤ï¼š")])]),s._v(" "),t("ol",[t("li",[s._v("å…ˆæ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…å«versionå­—æ®µ")]),s._v(" "),t("li",[s._v("æ ¹æ®idå’Œversionå­—æ®µå€¼ä½œä¸ºwhereæ¡ä»¶çš„å‚æ•°ï¼Œæ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒæ—¶version+1")]),s._v(" "),t("li",[s._v("åˆ¤æ–­æ“ä½œå½±å“è¡Œæ•°ï¼Œå¦‚æœå½±å“1è¡Œï¼Œåˆ™è¯´æ˜æ˜¯ä¸€æ¬¡è¯·æ±‚ï¼Œå¯ä»¥åšå…¶ä»–æ•°æ®æ“ä½œã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœå½±å“0è¡Œï¼Œè¯´æ˜æ˜¯é‡å¤è¯·æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚")])]),s._v(" "),t("h3",{attrs:{id:"_5-6-å»ºé˜²é‡è¡¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-å»ºé˜²é‡è¡¨"}},[s._v("#")]),s._v(" 5.6 å»ºé˜²é‡è¡¨")]),s._v(" "),t("p",[s._v("æœ‰æ—¶å€™æˆ‘ä»¬çš„è¡¨ä¸­éœ€è¦ä¸€äº›é‡å¤æ•°æ®ï¼Œåªæœ‰ä¸€äº›ç‰¹æ®Šåœºæ™¯æ‰ä¸éœ€è¦é‡å¤æ•°æ®ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¸Šé¢çš„å”¯ä¸€ç´¢å¼•æ–¹æ¡ˆå¯èƒ½å°±ä¸å¤ªè¡Œäº†ã€‚")]),s._v(" "),t("p",[s._v("è¿™æ—¶å€™ï¼Œç›´æ¥åœ¨è¡¨ä¸­åŠ å”¯ä¸€ç´¢å¼•ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªåˆé€‚çš„ã€‚")]),s._v(" "),t("p",[s._v("é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡"),t("code",[s._v("å»ºé˜²é‡è¡¨")]),s._v("æ¥è§£å†³é—®é¢˜ã€‚")]),s._v(" "),t("p",[s._v("ç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä»¬å†å•ç‹¬å»ºç«‹ä¸€å¼ è¡¨ï¼Œåªéœ€è¦å«æœ‰idå’Œå”¯ä¸€ç´¢å¼•ï¼Œå½“ç„¶å”¯ä¸€ç´¢å¼•å¯ä»¥æ˜¯å¤šä¸ªå­—æ®µæ¯”å¦‚ï¼šnameã€codeç­‰ç»„åˆèµ·æ¥çš„å”¯ä¸€æ ‡è¯†")]),s._v(" "),t("p",[t("strong",[s._v("æµç¨‹å›¾å¦‚ä¸‹ï¼š")]),s._v(" "),t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319423.png",loading:"lazy"}})]),s._v(" "),t("p",[t("strong",[s._v("å…·ä½“æ­¥éª¤ï¼š")])]),s._v(" "),t("ol",[t("li",[s._v("ç”¨æˆ·é€šè¿‡æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ”¶é›†æ•°æ®ã€‚")]),s._v(" "),t("li",[s._v("å°†è¯¥æ•°æ®æ’å…¥mysqlé˜²é‡è¡¨ã€‚")]),s._v(" "),t("li",[s._v("åˆ¤æ–­æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™åšmysqlå…¶ä»–çš„æ•°æ®æ“ä½œï¼ˆå¯èƒ½è¿˜æœ‰å…¶ä»–çš„ä¸šåŠ¡é€»è¾‘ï¼‰ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œæ•è·å”¯ä¸€ç´¢å¼•å†²çªå¼‚å¸¸ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚")])]),s._v(" "),t("h2",{attrs:{id:"_6-ä»£ç å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-ä»£ç å®è·µ"}},[s._v("#")]),s._v(" 6.ä»£ç å®è·µ")]),s._v(" "),t("p",[s._v("ä»¥ä¸Šæˆ‘ä»¬éƒ½æ˜¯ç»™å‡ºäº†ä¸€äº›å¤§æ¦‚çš„è§£å†³æ–¹æ¡ˆè·Ÿæ€è·¯ï¼Œæ¥ä¸‹æ¥Leoå“¥å¤§å®¶ä»¥Tokenæœºåˆ¶ä¸ºä¾‹ï¼Œç”¨ä»£ç å®ç°å¦‚æœè§£å†³æ¥å£çš„å¹‚ç­‰æ€§ã€‚")]),s._v(" "),t("p",[s._v("é¦–å…ˆæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹Tokenæœºåˆ¶çš„æ•´ä¸ªæµç¨‹ã€‚")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319465.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("ä¸‹é¢å¼€å§‹ç›´æ¥ä¸Šä»£ç ã€‚")]),s._v(" "),t("p",[s._v("é¦–å…ˆå‡†å¤‡ä¸€ä¸ªspringbootå·¥ç¨‹é¡¹ç›®ï¼Œåªéœ€è¦æ·»åŠ ä¸¤ä¸ªä¾èµ–å³å¯ã€‚")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319997.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("ç„¶åå¼€å§‹ç¼–å†™Rediså·¥å…·ç±»è·Ÿä¸€ä¸ªç®€å•çš„Tokenå·¥å…·ç±»ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("RedisService")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("token")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("beans"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("factory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Autowired")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RedisTemplate")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueOperations")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Component")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("concurrent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @author : Leo\n * @version 1.0\n * @date 2024-02-01 21:03\n * @description :\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RedisService")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RedisTemplate")]),s._v(" redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setEx")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" expireTime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueOperations")]),s._v(" ops "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            ops"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" expireTime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SECONDS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨\n     * @param key key\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exists")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TRUE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * åˆ é™¤key\n     * @param key key\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("remove")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exists")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TRUE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br")])]),t("p",[t("strong",[s._v("TokenService")])]),s._v(" "),t("p",[s._v("ä¸»è¦æ˜¯ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€ä¸é‡å¤çš„Tokenï¼Œä»¥åŠå‰ç«¯è¯·æ±‚è¿‡æ¥è¢«æ‹¦æˆªåéœ€è¦æ£€éªŒtokençš„æ–¹æ³•ã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("token")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("micrometer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("common"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("jakarta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exception"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("beans"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("factory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Autowired")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Component")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UUID")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @author : Leo\n * @version 1.0\n * @date 2024-02-01 21:01\n * @description :\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TokenService")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RedisService")]),s._v(" redisService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createToken")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" uuid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        redisService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setEx")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uuid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uuid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000L")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" uuid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkToken")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" token "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            token "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token ä¸å­˜åœ¨"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("redisService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exists")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"é‡å¤çš„æ“ä½œ"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" remove "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redisService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("remove")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("remove"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"é‡å¤çš„æ“ä½œ"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br")])]),t("p",[t("strong",[s._v("è‡ªå®šä¹‰å¹‚ç­‰æ³¨è§£")])]),s._v(" "),t("p",[s._v("æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªå¹‚ç­‰æ³¨è§£ï¼Œæ¥å¯¹æˆ‘ä»¬æƒ³è¦å¹‚ç­‰æ€§ä¸€è‡´çš„æ¥å£è¿›è¡Œæ ‡è¯†ã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @author : Leo\n * @version 1.0\n * @date 2024-02-01 21:17\n * @description : å¹‚ç­‰æ³¨è§£\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElementType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("METHOD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Retention")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RetentionPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUNTIME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AutoIdempotent")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("strong",[s._v("æ·»åŠ æ‹¦æˆªå™¨")])]),s._v(" "),t("p",[s._v("åœ¨æ‹¦æˆªå™¨ä¸­ï¼Œæˆ‘ä»¬è§£æå‡ºæ‰€æœ‰çš„è¯·æ±‚ï¼Œæ ‡æ³¨æœ‰å¹‚ç­‰æ³¨è§£çš„è¯·æ±‚ï¼Œæˆ‘ä»¬å»æ£€éªŒä»–çš„tokenï¼Œç„¶åæ¥å†³å®šä¸‹ä¸€æ­¥æ“ä½œã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interceptor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("jakarta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("jakarta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletResponse")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AutoIdempotent")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exception"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("javatop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("idempotent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TokenService")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("beans"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("factory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Autowired")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configuration")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Component")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("method"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HandlerMethod")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HandlerInterceptor")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ModelAndView")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @author : Leo\n * @version 1.0\n * @date 2024-02-01 21:14\n * @description :\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentInterceptor")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HandlerInterceptor")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TokenService")]),s._v(" tokenService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("preHandle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletResponse")]),s._v(" response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("handler "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("instanceof")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HandlerMethod")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HandlerMethod")]),s._v(" handlerMethod "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HandlerMethod")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AutoIdempotent")]),s._v(" idempotent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" handlerMethod"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMethod")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getAnnotation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AutoIdempotent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idempotent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" tokenService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkToken")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdempotentException")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br")])]),t("p",[t("strong",[s._v("æµ‹è¯•")])]),s._v(" "),t("p",[s._v("æœ€åç¼–å†™æ¥å£è¿›è¡Œæµ‹è¯•ã€‚")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319029.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("é¦–å…ˆç”Ÿæˆä¸€ä¸ªToken,ç„¶åæŠŠè¿™ä¸ªtokenæ”¾åˆ°helloæ¥å£çš„è¯·æ±‚å¤´ä¸Šé¢ã€‚")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319082.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€æ¬¡å¯ä»¥æ­£å¸¸è®¿é—®æ¥å£")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319071.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("ä½†å½“ä½ ç¬¬äºŒæ¬¡è®¿é—®è¯¥æ¥å£çš„æ—¶å€™ï¼Œå·²ç»æç¤ºä½ æ“ä½œé‡å¤äº†ã€‚å› ä¸ºåœ¨æˆ‘ä»¬ç¬¬ä¸€æ¬¡è®¿é—®æ¥å£ä¹‹åï¼Œå°±æŠŠRedisä¸­çš„tokenåˆ é™¤äº†ã€‚")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pic.yupi.icu/5563/202403241319144.png",loading:"lazy"}})]),s._v(" "),t("h2",{attrs:{id:"_7-æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-æ€»ç»“"}},[s._v("#")]),s._v(" 7.æ€»ç»“")]),s._v(" "),t("p",[s._v("ä»¥ä¸Šä¾¿æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹ï¼Œæœ¬äººæ‰ç–å­¦æµ…ï¼Œæ–‡ç« æœ‰ä»€ä¹ˆé”™è¯¯çš„åœ°æ–¹ï¼Œæ¬¢è¿å¤§ä½¬ä»¬æ‰¹è¯„æŒ‡æ­£ï¼æˆ‘æ˜¯"),t("strong",[s._v("Leo")]),s._v("ï¼Œä¸€ä¸ªåœ¨äº’è”ç½‘è¡Œä¸šçš„å°ç™½ï¼Œç«‹å¿—æˆä¸ºæ›´å¥½çš„è‡ªå·±ã€‚")])])}),[],!1,null,null,null);t.default=e.exports}}]);